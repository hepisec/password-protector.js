'use strict';var PasswordProtector={init:function(){let a=this;document.querySelectorAll("form[data-salt-field]").forEach(function(b){let c=b.querySelectorAll('input[type="password"]');if(!(1>c.length)){var d=b.dataset.saltField;b.addEventListener("submit",function(e){e.preventDefault();a.hashPasswordsAndSubmit(b,d,c)})}})},getPasswordKey:function(a){let b=new TextEncoder;return window.crypto.subtle.importKey("raw",b.encode(a),"PBKDF2",!1,["deriveBits","deriveKey"])},getPasswordDigest:async function(a,
b){let c=new TextEncoder;a=await window.crypto.subtle.deriveBits({name:"PBKDF2",salt:c.encode(a),iterations:3E5,hash:"SHA-256"},b,256);return Array.from(new Uint8Array(a)).map(d=>d.toString(16).padStart(2,"0")).join("")},hashPasswordsAndSubmit:async function(a,b,c){for(let e=0;e<c.length;e++){let f=c[e];var d=a.elements[b].value.trim().toLowerCase();let g=await this.getPasswordKey(a.elements[f.name].value);d=await this.getPasswordDigest(d,g);a.elements[f.name].value=d}a.submit()}};PasswordProtector.init();
